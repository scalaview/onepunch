{{{css "cmpower"}}}
{{{js "cmpower"}}}
<div id="input-page" class="page cell">
  <div class="bd">
    <div class="weui_cells_title"></div>
    <div class="weui_cells weui_cells_form">
      <div class="weui_cell">
          <div class="weui_cell_hd"><label class="weui_label">手机号</label></div>
          <div class="weui_cell_bd weui_cell_primary">
              <input class="weui_input" type="tel" placeholder="请输入手机号" id="cmpower-mobile" maxlength="11">
          </div>
      </div>
    </div>
    <a href="javascript:;" id="award" class="weui_btn weui_btn_primary">抽 奖</a>
    <hr>
    <div class="llb">
    </div>
    <div class="ml">
      <div class="weui_cells_title"><strong>流量充值说明</strong></div>
      <div class="weui_cells_title">
        <p><span style="color:HotPink;">流量类型：</span>2/3/4G通用（不含港澳台）</p>
        <p><span style="color:HotPink;">充值限制：</span>充值次数不限</p>
        <p><span style="color:HotPink;">到账时间：</span>1-10分钟内到账，24小时可充值</p>
        <p><span style="color:HotPink;">使用方式：</span>查询到流量即可使用</p>
        <p><span style="color:HotPink;">有效期限：</span>广东移动省内流量，<span style="color:orange;">有效期为20天</span>，月结不影响；其余流量，当月有效，<span style="color:orange;">月底清零</span></p>
      </div>
  </div>
  </div>
</div>

<div ontouchstart="" class="open-body" style="display:none">
  <div class="wrapper">

    <div class="bg rotate"></div>
    <div class="open-has ">
      <h3 class="title-close"><span class="user">您</span>获得一个宝箱</h3>
      <!-- <h3 class="title-open">恭喜你，成功领取<span class="user">德水</span>发的宝箱</h3> -->
      <h3 class="title-open"></h3>

      <div class="mod-chest">

        <div class="chest-close show ">
          <div class="gift">
            <div class="icon"></div>
          </div>
          <div class="tips">
            <i class="arrow"></i>
          </div>
        </div>
        <div class="chest-open">
          <div class="mod-chest-cont open-cont">
            <div class="content">
              <div class="gift">
              </div>
              <div class="func">
                <button class="chest-btn">查看详情并提取</button>
              </div>
            </div>
          </div>
        </div>

      </div>
    </div>
    <div class="open-none" style="display:none">
      <h3>你来晚啦，下次早点吧！</h3>
      <div class="mod-chest">
        <div class="chest-open show"></div>
      </div>
      <div class="func">
        <button class="chest-btn">查看领取详情</button>
      </div>
    </div>
    <div class="chest-notice">
      <input type="checkbox" id="notice-checkbox">
      <label for="notice-checkbox">关注JS代码网</label>
    </div>
  </div>
  <script type="text/javascript">

  $(".chest-close").click(function(){

    $(this).addClass("shake");
    var that=this;

    this.addEventListener("webkitAnimationEnd", function(){

      $(that).closest(".open-has").addClass("opened");
      setTimeout(function(){
        $(that).removeClass("show");
        $(that).closest(".mod-chest").find(".chest-open").addClass("show");
        setTimeout(function(){
          $(".chest-open").addClass("blur");
        },500)
      },200)
    }, false);
  })
</script>
</div>
<script type="text/javascript">
$(function(){
  $("#award").click(function(){
    var phone = $("#cmpower-mobile").val()
    if(!isMobile(phone)){
      showDialog("请输入正确的手机号码")
      return
    }
    $.ajax({
      url: "/cmpower",
      data: { phone: phone},
      method: "POST"
    }).then(function(data){
      // if(data.code){
        $("#input-page").hide()
        $(".title-open").html("恭喜你，</br>成功领取<span style='color:Red;'>"+data.msg+"</span>")
        $(".chest-open .gift").html(data.msg)
        $(".open-body").show()
      // }else{

      // }
    }).fail(function(err){
      console.log(err)
      showDialog("服务器错误")
    })
  })
})
</script>